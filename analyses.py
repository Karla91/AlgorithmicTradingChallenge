#!/usr/bin/python

import numpy as np
import pandas as pd
import statsmodels.api as sm

A = pd.read_csv('training.csv', nrows=50000, index_col=0, parse_dates = range(8, 205, 4))
#testSet = pd.read_csv('testing.csv', index_col=0, parse_dates = range(8, 205, 4))

X = A[['security_id', 'p_tcount', 'p_value', 'trade_vwap', 'trade_volume', 
	'time1', 'bid1', 'ask1',
	'time2', 'bid2', 'ask2',
	'time3', 'bid3', 'ask3',
	'time4', 'bid4', 'ask4',
	'time5', 'bid5', 'ask5',
	'time6', 'bid6', 'ask6',
	'time7', 'bid7', 'ask7',
	'time8', 'bid8', 'ask8',
	'time9', 'bid9', 'ask9',
	'time10', 'bid10', 'ask10',
	'time11', 'bid11', 'ask11',
	'time12', 'bid12', 'ask12',
	'time13', 'bid13', 'ask13',
	'time14', 'bid14', 'ask14',
	'time15', 'bid15', 'ask15',
	'time16', 'bid16', 'ask16',
	'time17', 'bid17', 'ask17',
	'time18', 'bid18', 'ask18',
	'time19', 'bid19', 'ask19',
	'time20', 'bid20', 'ask20',
	'time21', 'bid21', 'ask21',
	'time22', 'bid22', 'ask22',
	'time23', 'bid23', 'ask23',
	'time24', 'bid24', 'ask24',
	'time25', 'bid25', 'ask25',
	'time26', 'bid26', 'ask26',
	'time27', 'bid27', 'ask27',
	'time28', 'bid28', 'ask28',
	'time29', 'bid29', 'ask29',
	'time30', 'bid30', 'ask30',
	'time31', 'bid31', 'ask31',
	'time32', 'bid32', 'ask32',
	'time33', 'bid33', 'ask33',
	'time34', 'bid34', 'ask34',
	'time35', 'bid35', 'ask35',
	'time36', 'bid36', 'ask36',
	'time37', 'bid37', 'ask37',
	'time38', 'bid38', 'ask38',
	'time39', 'bid39', 'ask39',
	'time40', 'bid40', 'ask40',
	'time41', 'bid41', 'ask41',
	'time42', 'bid42', 'ask42',
	'time43', 'bid43', 'ask43',
	'time44', 'bid44', 'ask44',
	'time45', 'bid45', 'ask45',
	'time46', 'bid46', 'ask46',
	'time47', 'bid47', 'ask47',
	'time48', 'bid48', 'ask48',
	'time49', 'bid49', 'ask49',
	'time50', 'bid50', 'ask50']]

X1 = A[['security_id', 'p_tcount', 'p_value', 'trade_vwap', 'trade_volume', 
	'bid1', 'ask1',
	'bid2', 'ask2',
	'bid3', 'ask3',
	'bid4', 'ask4',
	'bid5', 'ask5',
	'bid6', 'ask6',
	'bid7', 'ask7',
	'bid8', 'ask8',
	'bid9', 'ask9',
	'bid10', 'ask10',
	'bid11', 'ask11',
	'bid12', 'ask12',
	'bid13', 'ask13',
	'bid14', 'ask14',
	'bid15', 'ask15',
	'bid16', 'ask16',
	'bid17', 'ask17',
	'bid18', 'ask18',
	'bid19', 'ask19',
	'bid20', 'ask20',
	'bid21', 'ask21',
	'bid22', 'ask22',
	'bid23', 'ask23',
	'bid24', 'ask24',
	'bid25', 'ask25',
	'bid26', 'ask26',
	'bid27', 'ask27',
	'bid28', 'ask28',
	'bid29', 'ask29',
	'bid30', 'ask30',
	'bid31', 'ask31',
	'bid32', 'ask32',
	'bid33', 'ask33',
	'bid34', 'ask34',
	'bid35', 'ask35',
	'bid36', 'ask36',
	'bid37', 'ask37',
	'bid38', 'ask38',
	'bid39', 'ask39',
	'bid40', 'ask40',
	'bid41', 'ask41',
	'bid42', 'ask42',
	'bid43', 'ask43',
	'bid44', 'ask44',
	'bid45', 'ask45',
	'bid46', 'ask46',
	'bid47', 'ask47',
	'bid48', 'ask48',
	'bid49', 'ask49',
	'bid50', 'ask50']]

testSet1 = testSet[['security_id', 'p_tcount', 'p_value', 'trade_vwap', 'trade_volume', 
	'bid1', 'ask1',
	'bid2', 'ask2',
	'bid3', 'ask3',
	'bid4', 'ask4',
	'bid5', 'ask5',
	'bid6', 'ask6',
	'bid7', 'ask7',
	'bid8', 'ask8',
	'bid9', 'ask9',
	'bid10', 'ask10',
	'bid11', 'ask11',
	'bid12', 'ask12',
	'bid13', 'ask13',
	'bid14', 'ask14',
	'bid15', 'ask15',
	'bid16', 'ask16',
	'bid17', 'ask17',
	'bid18', 'ask18',
	'bid19', 'ask19',
	'bid20', 'ask20',
	'bid21', 'ask21',
	'bid22', 'ask22',
	'bid23', 'ask23',
	'bid24', 'ask24',
	'bid25', 'ask25',
	'bid26', 'ask26',
	'bid27', 'ask27',
	'bid28', 'ask28',
	'bid29', 'ask29',
	'bid30', 'ask30',
	'bid31', 'ask31',
	'bid32', 'ask32',
	'bid33', 'ask33',
	'bid34', 'ask34',
	'bid35', 'ask35',
	'bid36', 'ask36',
	'bid37', 'ask37',
	'bid38', 'ask38',
	'bid39', 'ask39',
	'bid40', 'ask40',
	'bid41', 'ask41',
	'bid42', 'ask42',
	'bid43', 'ask43',
	'bid44', 'ask44',
	'bid45', 'ask45',
	'bid46', 'ask46',
	'bid47', 'ask47',
	'bid48', 'ask48',
	'bid49', 'ask49',
	'bid50', 'ask50']]

Y = A[['bid51', 'ask51',
	'bid52', 'ask52',
	'bid53', 'ask53',
	'bid54', 'ask54',
	'bid55', 'ask55',
	'bid56', 'ask56',
	'bid57', 'ask57',
	'bid58', 'ask58',
	'bid59', 'ask59',
	'bid60', 'ask60',
	'bid61', 'ask61',
	'bid62', 'ask62',
	'bid63', 'ask63',
	'bid64', 'ask64',
	'bid65', 'ask65',
	'bid66', 'ask66',
	'bid67', 'ask67',
	'bid68', 'ask68',
	'bid69', 'ask69',
	'bid70', 'ask70',
	'bid71', 'ask71',
	'bid72', 'ask72',
	'bid73', 'ask73',
	'bid74', 'ask74',
	'bid75', 'ask75',
	'bid76', 'ask76',
	'bid77', 'ask77',
	'bid78', 'ask78',
	'bid79', 'ask79',
	'bid80', 'ask80',
	'bid81', 'ask81',
	'bid82', 'ask82',
	'bid83', 'ask83',
	'bid84', 'ask84',
	'bid85', 'ask85',
	'bid86', 'ask86',
	'bid87', 'ask87',
	'bid88', 'ask88',
	'bid89', 'ask89',
	'bid90', 'ask90',
	'bid91', 'ask91',
	'bid92', 'ask92',
	'bid93', 'ask93',
	'bid94', 'ask94',
	'bid95', 'ask95',
	'bid96', 'ask96',
	'bid97', 'ask97',
	'bid98', 'ask98',
	'bid99', 'ask99',
	'bid100', 'ask100']]

X1 = sm.add_constant(X1)
testSet1 = sm.add_constant(testSet1)

predictions = result.predict(testSet1)

outIndexes = testSet.index[0:50000].reshape(50000,1)

csvOutput = np.concatenate((outIndexes, predictions), axis=1)

outHeader = 'row_id,bid51,ask51,bid52,ask52,bid53,ask53,bid54,ask54,bid55,ask55,bid56,ask56,bid57,ask57,bid58,ask58,bid59,ask59,bid60,ask60,bid61,ask61,bid62,ask62,bid63,ask63,bid64,ask64,bid65,ask65,bid66,ask66,bid67,ask67,bid68,ask68,bid69,ask69,bid70,ask70,bid71,ask71,bid72,ask72,bid73,ask73,bid74,ask74,bid75,ask75,bid76,ask76,bid77,ask77,bid78,ask78,bid79,ask79,bid80,ask80,bid81,ask81,bid82,ask82,bid83,ask83,bid84,ask84,bid85,ask85,bid86,ask86,bid87,ask87,bid88,ask88,bid89,ask89,bid90,ask90,bid91,ask91,bid92,ask92,bid93,ask93,bid94,ask94,bid95,ask95,bid96,ask96,bid97,ask97,bid98,ask98,bid99,ask99,bid100,ask100'

np.savetxt('verybad.csv', csvOutput, delimiter=',', fmt='%0.3f', header=outHeader, comments='') 
